name: Check Files

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-20.04
    steps:

      - name: Checkout source code
        uses: actions/checkout@v2

      - name: Install Dependencies
        run: pip install guardonce; git clone https://github.com/Sarcasm/run-clang-format.git

      - name: Check Header Guards
        continue-on-error: true
        working-directory: ${{runner.workspace}}/Atomic/
        run: wrongfiles=$(checkguard -r ./include/); echo $wrongfiles

      - name: Check File Names
        continue-on-error: true
        working-directory: ${{runner.workspace}}/Atomic/
        run: python ./tools/check_file_names.py 

      - name: Check Licenses
        continue-on-error: true
        working-directory: ${{runner.workspace}}/Atomic/
        run: python ./tools/check_licenses.py

      - name: Run Clang-Format
        continue-on-error: true
        working-directory: ${{runner.workspace}}/Atomic/
        run: python run-clang-format/run-clang-format.py -r --extensions= cpp,h,hpp ./include/ --style=file 